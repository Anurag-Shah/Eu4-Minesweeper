country_decisions = {
	minesweeper = {
		major = yes
		potential = {
			NOT = { has_global_flag = game_in_progress_flag }
			ROOT = { TAG = MSW }
		}

		allow = {
			hidden_trigger = {
				NOT = { has_global_flag = game_in_progress_flag }
				ROOT = { TAG = MSW }
			}
		}
		effect = {
			if = {
				limit = {
					NOT = {
						ROOT = { TAG = MSW }
					}
				}
				switch_tag = MSW
			}
			hidden_effect = {
				# Initialize flag
				set_global_flag	= game_in_progress_flag

				# Set score

				ROOT = {
					set_variable = {
					    which = score
					    value = 0
					}
				}

				ROOT = {
					set_variable = {
					    which = flags_placed
					    value = 0
					}
				}

				ROOT = {
					set_variable = {
					    which = bomb_total
					    value = 0
					}
				}

				ROOT = {
					set_variable = {
					    which = bomb_count
					    value = 0
					}
				}


				# Remove old modifiers and flags
				minesweeper_region = {
					# Needs to be separate from the main modifier block
					if = {
						limit = {
							has_province_modifier = flag_mod
						}
						remove_province_modifier = flag_mod
						ms_hide_flagged_tile_in_prov = yes
					}

					# Main modifier block
					if = {
						limit = {
							has_province_modifier = bomb_mod
						}
						remove_province_modifier = bomb_mod
						ms_hide_bomb_tile_in_prov = yes
					}
					else_if = {
						limit = {
							has_province_modifier = zero_mod
						}
						remove_province_modifier = zero_mod
						ms_hide_0_tile_in_prov = yes
					}
					else_if = {
						limit = {
							has_province_modifier = one_mod
						}
						remove_province_modifier = one_mod
						ms_hide_1_tile_in_prov = yes
					}
					else_if = {
						limit = {
							has_province_modifier = two_mod
						}
						remove_province_modifier = two_mod
						ms_hide_2_tile_in_prov = yes
					}
					else_if = {
						limit = {
							has_province_modifier = three_mod
						}
						remove_province_modifier = three_mod
						ms_hide_3_tile_in_prov = yes
					}
					else_if = {
						limit = {
							has_province_modifier = four_mod
						}
						remove_province_modifier = four_mod
						ms_hide_4_tile_in_prov = yes
					}
					else_if = {
						limit = {
							has_province_modifier = five_mod
						}
						remove_province_modifier = five_mod
						ms_hide_5_tile_in_prov = yes
					}
					else_if = {
						limit = {
							has_province_modifier = six_mod
						}
						remove_province_modifier = six_mod
						ms_hide_6_tile_in_prov = yes
					}
					else_if = {
						limit = {
							has_province_modifier = seven_mod
						}
						remove_province_modifier = seven_mod
						ms_hide_7_tile_in_prov = yes
					}
					else_if = {
						limit = {
							has_province_modifier = eight_mod
						}
						remove_province_modifier = eight_mod
						ms_hide_8_tile_in_prov = yes
					}

					# Main flag block
					if = {
						limit = {
							has_province_flag = bomb_flag
						}
						clr_province_flag = bomb_flag
					}
					else_if = {
						limit = {
							has_province_flag = zero_flag
						}
						clr_province_flag = zero_flag
					}
					else_if = {
						limit = {
							has_province_flag = one_flag
						}
						clr_province_flag = one_flag
					}
					else_if = {
						limit = {
							has_province_flag = two_flag
						}
						clr_province_flag = two_flag
					}
					else_if = {
						limit = {
							has_province_flag = three_flag
						}
						clr_province_flag = three_flag
					}
					else_if = {
						limit = {
							has_province_flag = four_flag
						}
						clr_province_flag = four_flag
					}
					else_if = {
						limit = {
							has_province_flag = five_flag
						}
						clr_province_flag = five_flag
					}
					else_if = {
						limit = {
							has_province_flag = six_flag
						}
						clr_province_flag = six_flag
					}
					else_if = {
						limit = {
							has_province_flag = seven_flag
						}
						clr_province_flag = seven_flag
					}
					else_if = {
						limit = {
							has_province_flag = eight_flag
						}
						clr_province_flag = eight_flag
					}
				}

				MSW = {
					country_event = {
						id = minesweeper.2
					}
				}
			}
		}
		ai_will_do = {
			factor = 0
		}
	}

	minesweeper_tutorial_decision = {
		major = yes
		effect = {
			hidden_effect = {
				country_event = {
					id = minesweeper.8
				}
			}
		}
	}

	minesweeper_view_flags_decision = {
		potential = {
			has_global_flag = game_in_progress_flag
		}

		allow = {
			hidden_trigger = { has_global_flag = game_in_progress_flag }
		}

		effect = {
			custom_tooltip = minesweeper_view_flags_decision_tooltip
		}
	}

	switch_to_msw_decision = {
		potential = {
			NOT = {
				ROOT = { TAG = MSW }
			}
		}
		allow = {
			hidden_trigger = {
				NOT = {
					ROOT = { TAG = MSW }
				}
			}
		}
		effect = {
			switch_tag = MSW
		}
	}
}
